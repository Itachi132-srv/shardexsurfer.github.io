<!DOCTYPE html>
<html>
<head>
<title>Neon Ball Breaker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Poppins:wght@500&display=swap');

html,body{
 margin:0;
 padding:0;
 overflow:hidden;
 background:#000;
 font-family:'Poppins',sans-serif;
 touch-action:none;
}

/* MENU */
#menu{
 position:fixed;
 inset:0;
 display:flex;
 flex-direction:column;
 justify-content:center;
 align-items:center;
 background:black;
 z-index:10;
}
#title{
 font-family:'Orbitron',sans-serif;
 font-size:clamp(28px,6vw,56px);
 margin-bottom:25px;
 animation:neon 4s infinite;
}
@keyframes neon{
 0%{color:#0ff;text-shadow:0 0 15px #0ff}
 50%{color:#f0f;text-shadow:0 0 15px #f0f}
 100%{color:#0ff;text-shadow:0 0 15px #0ff}
}
.menuBtn{
 width:220px;
 max-width:80vw;
 padding:14px;
 margin:10px;
 font-size:18px;
 border:none;
 border-radius:12px;
 font-weight:600;
 cursor:pointer;
}
#easy{background:#00ff88}
#medium{background:#ffee00}
#hard{background:#ff0033;color:white}

/* UI */
#ui,#best{
 position:fixed;
 top:10px;
 color:white;
 font-size:14px;
 display:none;
 z-index:5;
}
#ui{left:10px}
#best{right:10px}

canvas{display:none}

/* DEFEAT */
#defeat{
 position:fixed;
 inset:0;
 display:none;
 flex-direction:column;
 justify-content:center;
 align-items:center;
 background:black;
 z-index:20;
}
#defeat h1{
 font-family:'Orbitron',sans-serif;
 color:red;
 font-size:clamp(32px,6vw,60px);
 margin-bottom:20px;
}
.defeatBtn{
 width:200px;
 padding:12px;
 margin:8px;
 font-size:16px;
 border:none;
 border-radius:10px;
 cursor:pointer;
 font-weight:600;
}
#restartBtn{background:#00ff88}
#menuBtn{background:#00ccff}
</style>
</head>
<body>

<!-- MENU -->
<div id="menu">
 <div id="title">NEON BALL BREAKER</div>
 <button class="menuBtn" id="easy">EASY</button>
 <button class="menuBtn" id="medium">MEDIUM</button>
 <button class="menuBtn" id="hard">HARD</button>
</div>

<!-- UI -->
<div id="ui">Score: <span id="score">0</span></div>
<div id="best">Best: <span id="bestScore">0</span></div>

<!-- DEFEAT -->
<div id="defeat">
 <h1>DEFEAT</h1>
 <button class="defeatBtn" id="restartBtn">üîÅ Restart</button>
 <button class="defeatBtn" id="menuBtn">üè† Menu</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

const menu=document.getElementById("menu");
const defeat=document.getElementById("defeat");
const ui=document.getElementById("ui");
const bestDiv=document.getElementById("best");
const scoreSpan=document.getElementById("score");
const bestSpan=document.getElementById("bestScore");

function resize(){
 canvas.width=innerWidth;
 canvas.height=innerHeight;
}
resize(); addEventListener("resize",resize);

// GAME STATE
let paddle,balls,particles,score,settings;
let running=false;

// BEST SCORE
let best=localStorage.getItem("NEON_BEST")||0;
bestSpan.textContent=best;

// START GAME
function startGame(mode){
 settings={
  easy:{speed:2.5,gap:90},
  medium:{speed:4,gap:65},
  hard:{speed:5.5,gap:45}
 }[mode];

 score=0;
 scoreSpan.textContent=0;
 balls=[];
 particles=[];
 running=true;

 paddle={
  w:canvas.width*0.3,
  h:14,
  x:canvas.width/2,
  y:canvas.height-50,
  glow:0
 };

 menu.style.display="none";
 defeat.style.display="none";
 canvas.style.display="block";
 ui.style.display="block";
 bestDiv.style.display="block";

 requestAnimationFrame(loop);
}

// BUTTONS
easy.onclick=()=>startGame("easy");
medium.onclick=()=>startGame("medium");
hard.onclick=()=>startGame("hard");

restartBtn.onclick=()=>startGame("medium");
menuBtn.onclick=()=>{
 defeat.style.display="none";
 menu.style.display="flex";
};

// PC CONTROLS
let left=false,right=false;
addEventListener("keydown",e=>{
 if(e.key==="ArrowLeft") left=true;
 if(e.key==="ArrowRight") right=true;
});
addEventListener("keyup",e=>{
 if(e.key==="ArrowLeft") left=false;
 if(e.key==="ArrowRight") right=false;
});

// MOBILE CONTROL (FULL FIX)
canvas.addEventListener("touchstart",e=>{
 e.preventDefault();
 let x=e.touches[0].clientX;
 paddle.x=x;
},{passive:false});

canvas.addEventListener("touchmove",e=>{
 e.preventDefault();
 let x=e.touches[0].clientX;
 paddle.x=x;
},{passive:false});

// BALL SPAWN
function spawnBall(){
 let x;
 do{x=Math.random()*canvas.width}
 while(balls.some(b=>Math.abs(b.x-x)<settings.gap));

 balls.push({
  x,y:-20,r:12,
  s:settings.speed,
  c:`hsl(${Math.random()*360},100%,60%)`
 });
}

// END GAME
function endGame(){
 running=false;
 if(score>best){
  best=score;
  localStorage.setItem("NEON_BEST",best);
  bestSpan.textContent=best;
 }
 canvas.style.display="none";
 ui.style.display="none";
 bestDiv.style.display="none";
 defeat.style.display="flex";
}

// MAIN LOOP
function loop(){
 if(!running) return;

 ctx.clearRect(0,0,canvas.width,canvas.height);

 // paddle
 if(left) paddle.x-=8;
 if(right) paddle.x+=8;
 paddle.x=Math.max(paddle.w/2,Math.min(canvas.width-paddle.w/2,paddle.x));

 ctx.shadowBlur=paddle.glow;
 ctx.shadowColor="#00ff88";
 ctx.fillStyle="#00ffff";
 ctx.fillRect(paddle.x-paddle.w/2,paddle.y,paddle.w,paddle.h);
 ctx.shadowBlur=0;
 paddle.glow=Math.max(0,paddle.glow-1);

 // balls
 for(let i=balls.length-1;i>=0;i--){
  let b=balls[i];
  b.y+=b.s;

  ctx.beginPath();
  ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
  ctx.fillStyle=b.c;
  ctx.shadowBlur=20;
  ctx.shadowColor=b.c;
  ctx.fill();
  ctx.shadowBlur=0;

  if(b.y+b.r>=paddle.y && b.x>paddle.x-paddle.w/2 && b.x<paddle.x+paddle.w/2){
   balls.splice(i,1);
   score+=10;
   scoreSpan.textContent=score;
   paddle.glow=20;
   continue;
  }

  if(b.y-b.r>canvas.height){
   endGame();
   return;
  }
 }

 if(Math.random()<0.035) spawnBall();

 requestAnimationFrame(loop);
}
</script>
</body>
</html>
