<!DOCTYPE html>
<html>
<head>
<title>Neon Ball Breaker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html,body{
 margin:0;
 padding:0;
 overflow:hidden;
 background:black;
 font-family:Arial, sans-serif;
}
canvas{
 display:none;
}
#menu,#defeat{
 position:absolute;
 width:100%;
 height:100%;
 display:flex;
 flex-direction:column;
 justify-content:center;
 align-items:center;
 background:black;
}
button{
 padding:15px 35px;
 margin:10px;
 font-size:22px;
 border:none;
 border-radius:8px;
 color:white;
 cursor:pointer;
}
#easy{background:#00c853}
#medium{background:#ffeb3b;color:black}
#hard{background:#d50000}

#ui,#best{
 position:absolute;
 top:10px;
 color:white;
 font-size:16px;
 display:none;
}
#ui{left:10px}
#best{right:10px}
</style>
</head>
<body>

<div id="menu">
 <h1 style="color:white">Select Difficulty</h1>
 <button id="easy">Easy</button>
 <button id="medium">Medium</button>
 <button id="hard">Hard</button>
</div>

<div id="defeat" style="display:none">
 <h1 style="color:red;font-size:40px">DEFEAT</h1>
</div>

<div id="ui">Score: <span id="score">0</span></div>
<div id="best">Best: <span id="bestScore">0</span></div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const menu = document.getElementById("menu");
const defeat = document.getElementById("defeat");
const ui = document.getElementById("ui");
const bestDiv = document.getElementById("best");
const scoreSpan = document.getElementById("score");
const bestScoreSpan = document.getElementById("bestScore");

function resize(){
 canvas.width = innerWidth;
 canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

let paddle, balls, particles;
let score = 0;
let best = localStorage.getItem("bestScore") || 0;
bestScoreSpan.innerText = best;

let gameOver = false;
let settings = {};

function startGame(diff){
 settings = {
  easy:   {speed:2.5, gap:90},
  medium: {speed:4,   gap:65},
  hard:   {speed:5.5, gap:45}
 }[diff];

 score = 0;
 scoreSpan.innerText = score;
 balls = [];
 particles = [];
 gameOver = false;

 paddle = {
  w: canvas.width * 0.25,
  h: 14,
  x: canvas.width / 2,
  y: canvas.height - 40,
  color: "#00ffff"
 };

 menu.style.display = "none";
 defeat.style.display = "none";
 canvas.style.display = "block";
 ui.style.display = "block";
 bestDiv.style.display = "block";

 requestAnimationFrame(loop);
}

document.getElementById("easy").onclick = ()=>startGame("easy");
document.getElementById("medium").onclick = ()=>startGame("medium");
document.getElementById("hard").onclick = ()=>startGame("hard");

// controls
let left=false,right=false;
addEventListener("keydown",e=>{
 if(e.key==="ArrowLeft") left=true;
 if(e.key==="ArrowRight") right=true;
});
addEventListener("keyup",e=>{
 if(e.key==="ArrowLeft") left=false;
 if(e.key==="ArrowRight") right=false;
});

// mobile
let tx=null;
canvas.addEventListener("touchstart",e=>{
 tx = e.touches[0].clientX;
});
canvas.addEventListener("touchmove",e=>{
 let dx = e.touches[0].clientX - tx;
 paddle.x += dx;
 tx = e.touches[0].clientX;
});

function spawnBall(){
 let x;
 do{
  x = Math.random() * canvas.width;
 }while(balls.some(b => Math.abs(b.x - x) < settings.gap));

 balls.push({
  x: x,
  y: -20,
  r: 10 + Math.random()*6,
  speed: settings.speed + Math.random(),
  color: `hsl(${Math.random()*360},100%,60%)`
 });
}

function explode(x,y){
 for(let i=0;i<15;i++){
  particles.push({
   x,y,
   vx:(Math.random()-0.5)*6,
   vy:(Math.random()-0.5)*6,
   life:25
  });
 }
}

function endGame(){
 gameOver = true;
 if(score > best){
  best = score;
  localStorage.setItem("bestScore", best);
 }
 canvas.style.display="none";
 ui.style.display="none";
 bestDiv.style.display="none";
 defeat.style.display="flex";

 setTimeout(()=>{
  defeat.style.display="none";
  menu.style.display="flex";
 },2000);
}

function loop(){
 if(gameOver) return;

 ctx.fillStyle="black";
 ctx.fillRect(0,0,canvas.width,canvas.height);

 if(left) paddle.x -= 8;
 if(right) paddle.x += 8;
 paddle.x = Math.max(paddle.w/2, Math.min(canvas.width-paddle.w/2, paddle.x));

 ctx.fillStyle = paddle.color;
 ctx.fillRect(paddle.x-paddle.w/2, paddle.y, paddle.w, paddle.h);

 balls.forEach((b,i)=>{
  b.y += b.speed;
  ctx.beginPath();
  ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
  ctx.fillStyle=b.color;
  ctx.fill();

  if(
   b.y+b.r >= paddle.y &&
   b.x > paddle.x-paddle.w/2 &&
   b.x < paddle.x+paddle.w/2
  ){
   explode(b.x,b.y);
   balls.splice(i,1);
   score += 10;
   scoreSpan.innerText = score;
   paddle.color="#00ff00";
   setTimeout(()=>paddle.color="#00ffff",50);
  }

  if(b.y-b.r > canvas.height){
   endGame();
  }
 });

 particles.forEach((p,i)=>{
  ctx.fillStyle="white";
  ctx.fillRect(p.x,p.y,3,3);
  p.x+=p.vx; p.y+=p.vy; p.life--;
  if(p.life<=0) particles.splice(i,1);
 });

 if(Math.random() < 0.035) spawnBall();

 requestAnimationFrame(loop);
}
</script>
</body>
</html>
